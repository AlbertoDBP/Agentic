# Agent 02 — Newsletter Ingestion Service
# Production Environment Template
#
# USAGE:
#   cp .env.production.example .env
#   Fill in all required values (marked with REQUIRED)
#   Never commit .env to git
#
# On DigitalOcean droplet:
#   nano ~/Agentic/income-platform/src/agent-02-newsletter-ingestion/.env

# ── Database (DigitalOcean Managed PostgreSQL) ────────────────────────────────
# REQUIRED — get from DO dashboard → Databases → Connection string
DATABASE_URL=postgresql://user:password@host:port/dbname?sslmode=require

# ── Cache (DigitalOcean Managed Valkey) ──────────────────────────────────────
# REQUIRED — get from DO dashboard → Databases → Valkey → Connection string
REDIS_URL=rediss://default:password@host:port/0

# ── APIDojo Seeking Alpha API ─────────────────────────────────────────────────
# REQUIRED — get from rapidapi.com dashboard
APIDOJO_SA_API_KEY=your_rapidapi_key_here
APIDOJO_SA_HOST=seeking-alpha.p.rapidapi.com

# Seeking Alpha access token — unlocks paywalled article content
# OPTIONAL but recommended — get from V1 project .env (SEEKING_ALPHA_ACCESS_TOKEN)
SA_ACCESS_TOKEN=

# SA rate limiting + fetch config
SA_CALLS_PER_MINUTE=10
SA_FETCH_LIMIT_PER_ANALYST=20
SA_REQUEST_TIMEOUT=30

# ── AI Providers ──────────────────────────────────────────────────────────────
# REQUIRED — Claude Haiku (extraction) + Sonnet (philosophy)
ANTHROPIC_API_KEY=your_anthropic_key_here

# REQUIRED — text-embedding-3-small
OPENAI_API_KEY=your_openai_key_here

# ── Financial Modeling Prep ───────────────────────────────────────────────────
# REQUIRED for Intelligence Flow backtest (T+30/T+90 price checks)
FMP_API_KEY=your_fmp_key_here

# ── Service Config ────────────────────────────────────────────────────────────
ENVIRONMENT=production
LOG_LEVEL=info
SERVICE_PORT=8002

# ── AI Model Config ───────────────────────────────────────────────────────────
EXTRACTION_MODEL=claude-haiku-4-5-20251001
EXTRACTION_MAX_TOKENS=1500
PHILOSOPHY_MODEL=claude-sonnet-4-6
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536

# ── Cache TTLs (seconds) ──────────────────────────────────────────────────────
CACHE_TTL_CONSENSUS=1800        # 30 min
CACHE_TTL_ANALYST_SIGNAL=3600   # 60 min

# ── Flow + Scoring Thresholds ─────────────────────────────────────────────────
DEFAULT_AGING_DAYS=365
DEFAULT_HALFLIFE_DAYS=180
DEFAULT_MIN_DECAY_WEIGHT=0.1
DEFAULT_MIN_ACCURACY_THRESHOLD=0.5

# ── Prefect (optional — for flow orchestration UI) ────────────────────────────
# Leave blank to run flows without Prefect server (background tasks only)
PREFECT_API_URL=
